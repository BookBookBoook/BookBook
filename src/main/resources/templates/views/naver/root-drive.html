<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>네이버 웍스 드라이브 루트 목록 조회</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="container mt-5">
    <h2 class="mb-4">네이버 웍스 드라이브 루트 목록 조회</h2>

    <!-- 디버깅 정보 -->
    <div class="alert alert-info">
        <strong>디버그 정보:</strong>
        <p th:text="'rootfiles 존재 여부: ' + ${rootfiles != null}"></p>
        <p th:if="${rootfiles != null}" th:text="'rootfiles 크기: ' + ${#lists.size(rootfiles)}"></p>
        <p th:text="'전체 rootfiles 객체: ' + ${rootfiles}"></p>
    </div>

    <div th:if="${rootfiles != null and not #lists.isEmpty(rootfiles)}">
        <h3 class="mb-3">파일 목록</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>파일명</th>
                    <th>파일 ID</th>
                    <th>파일 크기</th>
                    <th>파일 유형</th>
                    <th>생성 날짜</th>
                    <th>작업</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="file : ${rootfiles}">
                    <td th:text="${file.fileName}"></td>
                    <td th:text="${#numbers.formatDecimal(file.fileSize / 1024, 0, 'COMMA', 2, 'POINT')} + ' KB'"></td>
                    <td th:text="${file.fileType}"></td>
                    <td th:text="${file.createdTime}"></td>
                    <td>
                        <form th:action="@{/drive/files}" method="post">
                          <input type="hidden" th:name="${_csrf != null ? _csrf.parameterName : '_csrf'}" 
                       th:value="${_csrf != null ? _csrf.token : ''}"/>
                            <input type="hidden" name="fileId" th:value="${file.fileId}">
                            <button type="submit" class="btn btn-primary btn-sm">하위 파일 보기</button>
                        </form>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div th:if="${rootfiles == null or #lists.isEmpty(rootfiles)}" class="alert alert-warning">
        조회된 파일이 없거나 rootfiles가 null입니다.
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>